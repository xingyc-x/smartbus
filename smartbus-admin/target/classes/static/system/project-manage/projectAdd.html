<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>添加项目</title>
    <!--框架必需-->
    <script src="/libs/quickui/libs/js/jquery.js"></script>
    <script src="/libs/quickui/libs/js/language/cn.js"></script>
    <script src="/libs/quickui/libs/js/framework.js"></script>
    <link rel="stylesheet" href="/libs/quickui/libs/css/import_basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" id="skin" prePath="/libs/quickui/" />
    <link rel="stylesheet" type="text/css" id="customSkin" />
    <!--框架必需end-->

    <!-- 日期选择框start -->
    <script type="text/javascript" src="/libs/quickui/libs/js/form/datePicker/WdatePicker.js"></script>
    <!-- 日期选择框end -->

    <!-- 数字步进器start -->
    <script type="text/javascript" src="/libs/quickui/libs/js/form/stepper.js"></script>
    <!-- 数字步进器end -->

    <script src="/libs/quickui/libs/js/form/form.js" type="text/javascript"></script>
    <!-- 表单验证start -->
    <script src="/libs/quickui/libs/js/form/validationRule.js" type="text/javascript"></script>
    <script src="/libs/quickui/libs/js/form/validation.js" type="text/javascript"></script>
    <!-- 表单验证end -->

    <script type="text/javascript"  src="getUrlParam.js"></script>
</head>
<style>
    .formLayoutContent{
        border: 0!important;
    }
    .formLayoutContent  .ele{
        /*在这里自定义表单元素容器宽度*/
    }
    .formLayoutContent  .eleValidateInfo{
        /*在这里自定义表单元素容器宽度*/
    }
</style>
<script>
    var closeWinStatus=0;
    function initComplete(){
        var sysUsers = JSON.parse(sessionStorage.getItem('sysUser'));
        $('#sysUserId').val(sysUsers.userId);

        //表单提交
        $('#form').submit(function(){
            //判断表单的客户端验证是否通过
            var valid = $('#form').validationEngine({returnIsValid: true});
            if(valid){
                $(this).ajaxSubmit({
                    //表单提交成功后的回调
                    success: function(responseText, statusText, xhr, $form){
                        if(!responseText.status){
                            top.Toast("showErrorToast", "添加项目失败！");
                        }
                        else{
                            top.Toast("showSuccessToast","添加项目成功！");
                            if(closeWinStatus==1){
                                saveCloseWinHandler();
                            }
                            else{
                                saveHandler();
                            }
                        }
                    }
                });
            }
            else{
                top.Toast("showErrorToast","表单填写不正确！");
            }

            //阻止表单默认提交事件
            return false;
        });



    }
    function submitHandler(closeWin){
         closeWinStatus=closeWin;
        //判断表单的客户端验证是否通过
        var valid = $('#form').validationEngine({returnIsValid: true, showOnMouseOver:false});
        if(valid){
            $('#form').submit()
        }
        //阻止表单默认提交事件
        return false;

    }


    //保存并关闭
    function saveCloseWinHandler(){
        //刷新数据,重排序，重置页码为1
        top.frmright.refresh(false);
        //关闭窗口
        top.Dialog.close();
    }
    //保存不关闭
    function saveHandler(){
        //刷新数据,重排序，重置页码为1
        top.frmright.refresh(false);
        $("#projectOrder").val("");
        $("#companyName").val("");
        $("#address").val("");
        $("#info").val("");
    }

        $(function(){
            $("#address").on("click", function() {
                var diag = new top.Dialog();
                diag.ID = "a11";
                diag.Title = "选择详细地址";
                diag.URL = "../../html/dialogContentMap.html";
                diag.Width = 800;
                diag.Height = 600;
                diag.show();
            });

    });

</script>
<body>
<div class="page_content">
    <div class="infoCard">
        <div class="title">
            <span>信息添加</span>
        </div>
        <div class="content">
            <table cellpadding="0" cellspacing="0" width="100%">
                <tr>
                    <td width="100%" class="ver01">
                        <form id="form" method="post" action="dialog_content_project.html" showOnMouseOver="false" >
                            <div class="formLayout">
                                <div class="formLayoutContent">
                                    <table class="formStyle">
                                        <input type="hidden" id ="sysUserId" name="sysUserId" />
                                        <tr>
                                            <td width="110" class="ali03">项目编号：</td>
                                            <td width="200">
                                                <!-- 当文本失去焦点时，会自动触发验证，将路径+ validateValue=输入值 拼成url&validateValue=root传到后台,传回false输出提示语-->
                                                <input type="text" id="projectOrder" name="order" value="" fillType="textinput" class="validate[required,custom[noSpecialCaracters],ajax[../../html/dialog_content_user_detail_revise.html|* 项目编号已存在!]]" />
                                            </td>
                                            <td width="15">
                                                <span class="star">*</span>
                                            </td>
                                            <td>
                                                <div class="validation_info">请输入英文或数字</div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td class="ali03">客户公司：</td>
                                            <td><input type="text" id="companyName" name="company" value="" fillType="textinput" class="validate[required] float_left"/></td>
                                            <td>
                                                <span class="star">*</span>
                                            </td>
                                            <td><div class="validation_info">请输入公司全称</div></td>
                                        </tr>

                                        <tr>
                                            <td class="ali03">详细地址：</td>
                                            <td ><input type="text" id="address" name="address" /></td>
                                            <td>
                                                <span class="star">*</span>
                                            </td>
                                            <td><div class="validation_info">请单击选择详细地址</div></td>

                                        </tr>
                                        <tr>
                                            <td class="ali03">项目简介：</td>
                                            <td colspan="3"><textarea  name="info" id="info" style="width:100%;" class="validate[required]"></textarea></td>
                                            <td>
                                                <span class="star">*</span>
                                            </td>
                                        </tr>


                                    </table>


                                </div>
                            </div>
                        </form>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
</body>
</html>